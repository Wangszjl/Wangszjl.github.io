[{"title":"有限元初步（一）（翻译）","url":"/2024/07/30/有限元初步（一）/","content":"# 摘译-使用有限元方法求解泊松方程（一）\n本内容翻译自《Plasma Simulations by Example》(Lubos Brieda，2019），用于在三维空间内求解泊松方程。\n\n## 1 强形式\n泊松方程可以写为\n$$\\nabla^2u\\equiv\\frac{\\partial^2u}{\\partial x^2}+\\frac{\\partial^2u}{\\partial y^2}+\\frac{\\partial^2u}{\\partial z^2}\\equiv u_{,ii}=f\\tag{1.1}$$\n\n在强形式中，我们通常将方程和边界条件写成积分形式，其中下标跟在逗号后面的表示导数，重复的下标意味着求和。这种记号方法被称为指标记号或爱因斯坦记号。我们感兴趣的是在某个空间域$\\Omega$上求解这个方程。为了获得唯一解，我们还需要指定边界条件。我们假设我们知道在边界的一个子集$\\Gamma_g$上的解。即满足**狄利克雷边界条件**。我们还假设在另一个子集$\\Gamma_h$上我们知道解的导数,即满足**纽曼边界条件**。因此，按照爱因斯坦标记法，上述强形式表述为：\n<br>给定$f$：$\\Omega\\rightarrow R$，$g:\\Gamma_g\\rightarrow R$，且$h:\\Gamma_h\\rightarrow R$，寻找$u:\\Omega\\rightarrow R$使得$-ku_{,ii}=f(\\Omega)$,$u=g(\\Gamma_g)$\n\n<br>针对泊松方程求解问题，$u=\\phi，k=1$且$f=\\rho/\\epsilon_0$。需要注意的是，$\\Gamma_g\\notin\\emptyset$，但是$\\Gamma_h$可以是一个空集。狄利克雷边界条件是获得唯一解所必须的边界条件，但是纽曼边界条件可选。两类边界条件不需要连续，我们可以拥有多个非连续的$\\Gamma_g$和$\\Gamma_h$区域。\n\n## 2 弱形式\n弱形式使用两种函数定义解：\n\n* 试解\n* 权重函数（变量）\n<br>解需要满足边界条件，即在$\\Gamma_g$上$u=g$。同时要求解的导数平方可积：\n<br>$$\\int_\\Omega(u_{,i})^2d\\Omega<\\infty\\tag{2.1}$$\n<br>满足上述条件的函数称作$H^1$函数，因此$u\\in H^1$。试解的集合由下式给出：$S=\\{u|u\\in H^1,u=g | \\Gamma_g\\}$\n<br>权重函数与解相似，不同的是他们只满足$g$边界条件的齐次形式：\n$V=\\{w|w\\in H^1,w=0|\\Gamma_g\\}$\n<br>于是弱形式由下述形式给出：\n<br>给定$f:\\Omega\\rightarrow R, g:\\Gamma_g\\rightarrow R, h:\\Gamma_h\\rightarrow R, 找到u\\in S,使得对所有的w\\in V,满足\\int_\\Omega w_{,i}(ku_{,i})d\\Omega=\\int_\\Omega wfd\\Omega+\\int_{\\Omega_h}whd\\Gamma$\n\n<br>与强形式不同，弱形式通过$u$的导数来定义解。这两个解是相同的，如果$u$是$(S)$的解，那么它也是$(W)$的解，如果$u$是$(W)$的解，那么它也是$(S)$的解。我们现在定义几个新的算子以简化记号:\n$$a(w,u)=\\int_\\Omega w_{,i}ku_{,i}d\\Omega\\tag{2.2}$$\n$$(w,f)=\\int_\\Omega wfd\\Omega\\tag{2.3}$$\n$$(w,f)=\\int_{\\Omega_h}wfd\\Omega\\tag{2.4}$$\n\n## 3 伽辽金形式\n接下来在离散化域$\\Omega_h$上近似弱形式。第一步是构建$S$和$V$的有限维近似。代替连续函数，我们现在有了子集$S^h$和$V^h$，其中$S^h\\in S$，$V^h\\in V$。下标$h$表示与网格相关联的属性。因此，如果$u^h\\in S^h$，则$u^h\\in S$。边界条件也成立，即$u^h = g$在$\\Gamma_g$上成立。同样，$V^h$的所有成员在$\\Gamma_g$上消失。然后，我们可以让$S^h$的每个成员由下式表述：\n$$u^h=v^h+g^h\\tag{3.1}$$\n式中$v^h\\in V^h$，$g^h$为在$\\Gamma_g$上满足$u=g$的集合，于是有了伽辽金形式的描述。\n>给定$f$，$g$和$h$，寻找$u^h=v^h+g^h\\in S^h$，使得对于所有的$w^h\\in V^h$，$a(w^h,v^h)=(w^h,f)+(w^h,h)_\\Gamma-a(w^h,g^h)$\n\n## 4 形函数\n假设我们的域由$\\eta = \\{0, 1, …, n_{np−1}\\}$个节点组成。在这些节点中，狄利克雷$g$边界条件被指定的节点由$\\eta_g$给出。那么，$\\eta - \\eta_g$就是解$u^h$需要被确定的节点子集。接下来，我们让$V^h$的成员采取以下形式：\n$$w^h(\\vec{x})=\\sum_{A\\in\\eta-\\eta_g}N_A(\\vec{x})c_A\\tag{4.1}$$\n$$v^h(\\vec{x})=\\sum_{A\\in\\eta-\\eta_g}N_A(\\vec{x})d_A\\tag{4.2}$$\n式中$d_A$为要求解的未知变量。$g$的节点值使用形函数插值得到：\n$$g^h(\\vec{x})=\\sum_{A\\in\\eta_g}N_A(\\vec{x})g_A,g_A=g(\\vec{x_A})\\tag{4.3}$$\n将这些插值函数代入到伽辽金表达式中，得到\n$$\\sum_{B\\in\\eta-\\eta_g}a(N_A,N_B)d_B=(N_A,f)+(N_A,h)_\\Gamma-\\sum_{B\\in\\eta_g}a(N_A,N_B)g_B,$$\n$$A\\in\\eta-\\eta_g\\tag{4.4}$$\n\n## 5 矩阵形式\n定义$K_{AB}=a(N_A,N_B)$，$F_A=(N_A,f)+(N_A,h)_\\Gamma-\\sum_{B\\in\\eta_g}a(N_A,N_B)g_B,A\\in\\eta-\\eta_g$，则式（4.4）变为\n$$\\sum_{B\\in\\eta-\\eta_g}K_{AB}d_B=F_A\\tag{5.1}$$\n进一步使用矩阵形式表述为\n$$\\boldsymbol{K}=[K_{AB}]=\n\\left[\n  \\begin{matrix}\n  K_{0,0}&K_{0,1}&...&K_{0,n-1}\\\\\n  K_{1,0}&K_{1,1}&...&K_{1,n-1}\\\\\n  ...&...&...&...\\\\\n  K_{n-1,0}&K_{n-1,1}&...&K_{n-1,n-1}\n  \\end{matrix}\n  \\right]\\tag{5.2}$$\n$$\\vec{F}=\\{F_A\\}=\n\\left\\{\n  \\begin{matrix}\n  F_0\\\\\n  F_1\\\\\n  ...\\\\\n  F_{n-1}\n  \\end{matrix}\n  \\right\\}\\tag{5.3}$$\n$$\\vec{d}=\\{d_B\\}=\n\\left\\{\n  \\begin{matrix}\n  d_0\\\\\n  d_1\\\\\n  ...\\\\\n  d_{n-1}\n  \\end{matrix}\n  \\right\\}\n$$\n上述矩阵形式表述为\n$$\\boldsymbol{K}\\vec{d}=\\vec{F}\\tag{5.4}$$\n式中$K$为***刚度矩阵***，$\\vec{F}$为受力项，$\\vec{d}$为位移矢量。矩阵形式表述为\n<br>给定系数矩阵$\\boldsymbol{K}$和向量$\\vec{F}$，寻找$\\vec{d}$满足$\\boldsymbol{K}\\vec{d}=\\vec{F}$,其中$\\boldsymbol{K}=[K_{PQ}]$，$\\vec{d}=\\{d_q\\}$，$\\vec{F}=\\{F_p\\}$，$0\\le P,Q<n_{eq}，K_{PQ}=a(N_A,N_B)，P=ID(A),Q=ID(B)，F_P=(N_A,f)+(N_A,h)_\\Gamma-\\sum_{B\\in\\eta_{eq}}a(N_A,N_B)G_B$\n\n需要注意的是，我们只对未知节点$n_{eq}=n_{np}-n_g$应用上述等式，我们需要找到节点标号与未知方程标号的对应关系，我们根据Hughes标记法将其称为ID：\n$$ID(A)=\n\\begin{cases}\nP&A\\in\\eta-\\eta_g\\\\\n0&A\\in\\eta_g\n\\end{cases}\n\\tag{5.5}$$\n\n## 6 单元视角\n上述表述使用了全局视角来表述矩阵问题。在这个视角中，空间位置和插值函数NA在物理$\\vec{x}$坐标中给出。这种表述方式并不实用，因此我们改为使用单元视角。我们让每个元素覆盖一些逻辑域，其坐标为$\\vec{\\xi} = \\{\\xi,\\eta,\\zeta\\}$。现在，插值函数$N_{0,1},…$以这些逻辑或自然坐标表示。整个域的积分现在可以重写为对所有单元的求和。\n$$\\boldsymbol{K}=\\sum^{n_{el}-1}_{e=0}\\boldsymbol{K}^e,\\boldsymbol{K}^e=[K^e_{AB}]\\tag{6.1}$$\n$$\\vec{F}=\\sum^{n_{el}-1}_{e=0}\\vec{F}_e,\\vec{F}_e=\\{F^e_A\\}\\tag{6.2}$$\n其中\n$$K^e_{AB}=a(N_A,N_B)^b=\\int_{\\Omega^e}\\nabla N_A k\\nabla N_B d\\Omega\\tag{6.3}$$\n$$F^e_p=(N_A,f)^e+(N_A,h)^e_\\Gamma-\\sum_{B\\in\\eta_g}a(N_A,N_B)^eg_B\\\\\n=\\int_{\\Omega^e}N_Afd\\Omega+\\int_{\\Gamma^e_h}N_Ahd\\Gamma-\\sum_{B\\in\\eta_g}a(N_A,N_B)^eg_B\\tag{6.4}$$\n在有限元方法中，矩阵方程的单元表述涉及到刚度矩阵的各个元素。这些元素由$a(N_A, N_B)^e$表示，其中$N_A$和$N_B$是插值函数，$e$表示元素编号。刚度矩阵的这些元素代表了该元素内部及其与相邻元素连接处的力与位移的关系。$\\Gamma^e_h$是元素$e$在边界$\\Gamma_h$上的部分，这个边界仅对于位于域边界的元素非空。此外，$P$和$Q$分别是刚度矩阵A和载荷向量B的单元编号映射，即$P = ID(A)$和$Q = ID(B)$。这里的ID表示节点编号与未知方程编号之间的映射表。\n<br>通过计算每个元素在刚度矩阵中的贡献，并将这些贡献加在一起，我们可以得到整个域的刚度矩阵。这个过程涉及到对每个元素内部及其与相邻元素的交界面进行积分。这种方法使得我们可以有效地处理复杂的几何形状和边界条件，同时确保解在指定的边界上满足给定的条件。\n<br>对单个单元重写上述公式为\n$$k^e=[k^e_{ab}],f^e=\\{f^e_a\\},0\\le a,b<n_{en}\\tag{6.5} $$\n$$k^e_{ab}=a(N_a,N_b)^e=\\int_{\\Omega^e}N_afd\\Omega+\\int_{\\Omega^e}N_ahd\\Gamma-\\sum^{n_{en}}_{b=1}k^e_{ab}q^e_b\\tag{6.6}$$\n\n## 7 正交\n假设存在一个从物理坐标到自然（或逻辑）坐标$\\vec{\\eta}=(\\xi,\\eta,\\zeta)$的映射，使得：\n$$x(\\vec{\\eta})=\\sum^4_{a=1}N_a(\\vec{\\xi})\\vec{x}^e_a\\tag{7.1}$$\n式中$\\vec{x}^e_a$是组成单元$e$的四个节点的位置，且$\\xi，\\eta，\\zeta\\in[-1:1]$。这个公式描述了物理坐标可以作为逻辑坐标的函数，可用于对节点位置的插值计算。接下来将积分转换为$\\vec{\\xi}$空间下的积分：\n$$\\int_{\\Omega^e}f(\\vec{x})dxdydz=\\int^1_{-1}\\int^1_{-1}\\int^1_{-1}f(x(\\vec{\\xi}),y(\\vec{\\xi}),z(\\vec{\\xi}))j(\\vec{\\xi})d\\xi d\\eta d\\zeta\\tag{7.2}$$\n式中$j(\\vec{\\xi})=\\partial x_i/\\partial\\xi_i$称为***雅可比矩阵***。\n\n## 8 形状函数及坐标转换\n下面求解\n$$k^e_{ab}=a(N_a,N_b)^e=\\int_{\\Omega^e}N_{a,i}kN_{b,i}d\\Omega\\tag{8.1}$$\n我们可以在逻辑坐标空间$\\vec{\\xi}$中计算。使用链式法则，\n$$\\frac{\\partial N_a}{\\partial x}=\\frac{\\partial N_a}{\\partial\\xi}\\frac{\\partial\\xi}{\\partial x}+\\frac{\\partial N_a}{\\partial\\eta}\\frac{\\partial\\eta}{\\partial x}\\tag{8.2}$$\n或使用爱因斯坦标记法表示为\n$$N_{a,x}=N_{a,\\xi}\\xi_{,x}+N_{a,\\eta}\\eta_{,x}\\tag{8.3}$$\n相似地，\n$$N_{a,y}=N_{a,\\xi}\\xi_{,y}+N_{a,\\eta}\\eta_{,y}\\tag{8.4}$$\n从上式可以得到，我们需要获得$N_a$在逻辑空间中的形函数，$N_a=N_a(\\xi)$。我们也需要映射$\\vec{\\xi}_{,\\vec{x}}$的表达式，于是有\n$$\\int\\Omega f(\\vec{x})d\\Omega=\\int_\\xi f(\\vec{\\xi})|\\vec{x}_{,\\vec{\\xi}}|d\\vec{\\xi}\\tag{8.5}$$\n将式（8.4）和式（8.5）重写为矩阵形式\n$$\\left\\{\n  \\begin{matrix}\n  N_{a,x}\\\\\n  N_{a,y}\n  \\end{matrix}\n  \\right\\}=\n  \\left\\{\n  \\begin{matrix}\n  N_{a,\\xi}\\\\\n  N_{a,\\eta}\n  \\end{matrix}\n  \\right\\}\n  \\left[\n  \\begin{matrix}\n  \\xi_x&\\xi_y\\\\\n  \\eta_x&\\eta_y\n  \\end{matrix}\n  \\right]\\tag{8.6}\n  $$\n  根据$x(\\xi,\\eta)=\\sum^2_{a=0}N_a(\\xi,\\eta)x^e_a，y(\\xi,\\eta)=\\sum^2_{a=0}N_a(\\xi,\\eta)y^e_a$，计算得到\n  $$\\vec{x}_{,\\vec{\\xi}}=\n    \\left[\n  \\begin{matrix}\n  x_{,\\xi}&x_{,\\eta}\\\\\n  y_{,\\xi}&y_{,\\eta}\n  \\end{matrix}\n  \\right]\\tag{8.6}\n  $$\n  而$\\vec{\\xi_{,\\vec{x}}}=(\\vec{x}_{,\\xi})^{-1}$。\n<br>根据以上内容，计算任意单元内$N_{a,x}$和$N_{b,x}$的步骤如下：\n<br>1.计算正交点$l_{\\xi}$处的$N_{a,\\xi}$；\n<br>2.使用$N_{a,\\xi}$计算$\\vec{x}_{,\\vec{\\xi}}$;\n<br>3.计算$\\vec{\\xi_{,\\vec{x}}}=(\\vec{x}_{,\\xi})^{-1}$；\n<br>4.使用$N_{a,\\xi}\\xi_{,x}$计算$N_{a,x}$\n<br>5.对b重复1-4。","categories":["FEM"]}]