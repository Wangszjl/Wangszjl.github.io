<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf8" />
    <meta name="viewport" content="initial-scale=1.0, width=device-width" />
    <title>
      
        03-有限元理论推导（一） | 芥川龙之介的幽灵
      
    </title>
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    
      <link rel="apple-touch-icon"
            sizes="180x180"
            href="/images/apple-touch-icon.png" />
    
    
      <link rel="icon"
            type="image/png"
            sizes="32x32"
            href="/images/favicon-32x32.png" />
    
    
      <link rel="icon"
            type="image/png"
            sizes="16x16"
            href="/images/favicon-16x16.png" />
    
    
      <link rel="mask-icon"
            href="/images/logo.svg"
            color="" />
    
    
    
      
  <style>
    @font-face {
        font-family:sourceHanSerif;
        src: url(/font/normal.ttf);
        font-weight: normal;
    }
  </style>

  <style>
    @font-face {
        font-family:sourceHanSerif;
        src: url(/font/bold.ttf);
        font-weight: bold;
    }
  </style>


    
    <link rel="stylesheet"
          type="text/css"
          href='/css/layout.css' />
    
    
  <link rel="stylesheet" type="text/css" href="/css/post.css"/>
  

  <meta name="generator" content="Hexo 7.3.0"></head>
  <body>
    
      <div id="search-mask" style="display:none">
  <div class="search-main" id="search-main">
    <div class="search__head">
      <div class="search-form">
        <svg t="1706347533072"
             class="icon"
             viewBox="0 0 1024 1024"
             version="1.1"
             xmlns="http://www.w3.org/2000/svg"
             p-id="7828"
             width="20"
             height="20">
          <path d="M685.6 660.336l155.152 155.168a16 16 0 0 1 0 22.624l-11.312 11.328a16 16 0 0 1-22.624 0l-158.528-158.544a289.792 289.792 0 0 1-165.152 51.36C322.336 742.256 192 611.904 192 451.12 192 290.336 322.336 160 483.136 160c160.784 0 291.12 130.336 291.12 291.136 0 82.112-33.984 156.272-88.672 209.2z m-202.464 33.92c134.272 0 243.12-108.848 243.12-243.12C726.256 316.848 617.408 208 483.136 208 348.848 208 240 316.848 240 451.136c0 134.272 108.848 243.12 243.136 243.12z" fill="#000000" p-id="7829">
          </path>
        </svg>
        <input id="search-input" placeholder="搜索文章">
        <svg t="1706361500528"
             id="search-clear"
             class="icon"
             viewBox="0 0 1024 1024"
             version="1.1"
             xmlns="http://www.w3.org/2000/svg"
             p-id="4351"
             width="20"
             height="20">
          <path d="M512 562.688l-264.2944 264.2944-50.688-50.688L461.312 512 197.0176 247.7056l50.688-50.688L512 461.312l264.2944-264.2944 50.688 50.688L562.688 512l264.2944 264.2944-50.688 50.688L512 562.688z" fill="#00" p-id="4352">
          </path>
        </svg>
      </div>
    </div>
    <div class="search__body" id="search-result"></div>
    <div class="search__foot"></div>
  </div>
</div>

    
    <div class="head">
      <div class="nav">
        <a href='/' class="nav-logo">
          <img alt="logo" height="60px" width="60px" src="/images/logo.svg" />
        </a>
        <input id="navBtn" type="checkbox" />
        <div class="nav-right">
          
            <div class="search-outer">
  <div class="search" id="search-btn">
    <svg t="1706347533072"
         class="icon"
         viewBox="0 0 1024 1024"
         version="1.1"
         xmlns="http://www.w3.org/2000/svg"
         p-id="7828"
         width="20"
         height="20">
      <path d="M685.6 660.336l155.152 155.168a16 16 0 0 1 0 22.624l-11.312 11.328a16 16 0 0 1-22.624 0l-158.528-158.544a289.792 289.792 0 0 1-165.152 51.36C322.336 742.256 192 611.904 192 451.12 192 290.336 322.336 160 483.136 160c160.784 0 291.12 130.336 291.12 291.136 0 82.112-33.984 156.272-88.672 209.2z m-202.464 33.92c134.272 0 243.12-108.848 243.12-243.12C726.256 316.848 617.408 208 483.136 208 348.848 208 240 316.848 240 451.136c0 134.272 108.848 243.12 243.136 243.12z" fill="#000000" p-id="7829">
      </path>
    </svg>
    <span>搜索</span>
    <span class="search-shortcut-key">Ctrl K</span>
  </div>
</div>

          
          <div class="nav-menu">
            
              
                <a class="nav-menu-item" href="/Numerical">数学迷思</a>
              
                <a class="nav-menu-item" href="/Physics">物理揭秘</a>
              
                <a class="nav-menu-item" href="/FEM">探寻有限元</a>
              
                <a class="nav-menu-item" href="/Program">代码精进之路</a>
              
            
            <a class="nav-menu-item" href='/cv/'>简历</a>
          </div>
        </div>
        <label class="nav-btn" for="navBtn"></label>
      </div>
    </div>
    <div class="body">
      
  <article class="post-content">
    <div class="post-inner">
      <div class="post-content__head">
        <div class="post-title">03-有限元理论推导（一）</div>
        <div class="post-info">
          
  


          <span class="post-date">2024-08-31</span>
        </div>
      </div>
      
      <div class="post-content__body">
        
          <div class="post-gallery">
            
          </div>
        
        <h1 id="加权残差法和伽辽金近似">1 加权残差法和伽辽金近似</h1>
<h2 id="经典问题引入">1.1 经典问题引入</h2>
<p>考虑确定一根长度为<span class="math inline">\(L\)</span>、横截面恒定的细长均质金属杆用户的热传导情况。假定左端暴露在规定的热通量<span class="math inline">\(q\)</span>下，右端保持恒温<span class="math inline">\(T=T_L\)</span>，并且棒的长度方向被绝缘材料包围。利用傅立叶定律，我们可以写出控制整个棒的温度分布的导线方程，即：
<span class="math display">\[-K\frac{d^2T}{dx^2}=Q，0&lt;x&lt;L\tag{1.1}\]</span>
式中 <br><span class="math inline">\(x\)</span>为长度坐标 <br><span class="math inline">\(K\)</span>是材料的热传导率（假定为常数） <br><span class="math inline">\(Q\)</span>是单位体积产生的热量
与这一问题相应的边界条件是 <span class="math display">\[-K\frac{dT}{dx}=q，x=0\tag{1.2}\]</span> <span class="math display">\[T=T_L，x=L\tag{1.3}\]</span> 当<span class="math inline">\(q&gt;0\)</span>时，热量流向<span class="math inline">\(x=0\)</span>处的棒体，这就是公式(1.2)中负号的原因。</p>
<p>假定<span class="math inline">\(Q\)</span>是可积的，那么方程(1.1)的解与边界条件(1.2)和(1.3)可以通过直接积分求得：
<span class="math display">\[T(x)=T_L+\frac{q}{K}(L-x)+\frac{1}{K}\int^L_x(\int^x_0Q(z)dz)dy\tag{1.4}\]</span>
如果Q为常数，公式(1.4)简化为： <span class="math display">\[T(x)=T_L+\frac{q}{K}(L-x)+\frac{Q}{2K}(L^2-x^2)\tag{1.5}\]</span></p>
<h2 id="弱形式描述">1.2 弱形式描述</h2>
<p>通常有两种方法可以用有限元来计算和求解方程(1.1)的形式,这两种方法分别称为<strong><em>Rayleigh-Ritz法</em></strong>和<strong><em>Galerkin法</em></strong>。其他较少使用的方法是基于配位、常数加权和最小平方技术。所有这些程序都是加权残差法的子集。
<br>无论我们使用哪种方法，第一步都是在<span class="math inline">\(0\le x
\le
L\)</span>的区间内划分出网格，网格由一定数量的非重叠子区间组成，覆盖整个域，每个子区间称为一个
"单元"。我们用<span class="math inline">\(e_k\)</span>表示每个单元，即<span class="math inline">\(e_k=\{x:x_k\le x\le
x_{k+1}\}\)</span>。每个子区间的端点<span class="math inline">\(x_k\)</span>称为节点。
温度分布由每个子区间的预设函数（用<span class="math inline">\(\phi_j(x)\)</span>表示）和相应的未知参数<span class="math inline">\(a_j\)</span>计算得到。
<br>因此，我们将一个单元定义为一个子区间<span class="math inline">\(e_k\)</span>，以及一组预先确定的函数<span class="math inline">\(\varphi_j\)</span>和相同数量的参数<span class="math inline">\(a_j\)</span>。这样如果参数<span class="math inline">\(a_j\)</span>已知，则温度长边的近似值<span class="math inline">\(T(x)\)</span>也是已知的。在整个域<span class="math inline">\(0 \le x \le L\)</span>上，我们可以写出 <span class="math display">\[T(x)\cong
a_1\phi_1(x)+a_2\phi_2(x)+\cdots+a_{n+1}\phi_{n+1}(x)\tag{1.6}
\]</span> 函数<span class="math inline">\(\phi(x)\)</span>称作形状函数，我们将式（1.6）写成求和的形式，即
<span class="math display">\[T(x)=\sum^{n+1}_{i=1}a_i\phi_i(x)\tag{1.7}
\]</span>
<br>Ritz方法从数学的角度更满足预期，可以让我们形成更近似和收敛的数理论，但是在解决流体和热传导问题时，显得捉襟见肘。
当使用 (1.7)
形式的表达式近似求解问题时,一般来说，我们无法得到这个偏微分方程的真实解。因此，如果我们将近似解替换为方程（1.1）的左侧，我们得到的将不是同一值，而是与误差相关的某个
"残差 "函数。我们将这个残余误差定义为 <span class="math display">\[R(T,x)\equiv-K\frac{d^2T}{dx^2}-Q\tag{1.8}\]</span>
这里，<span class="math inline">\(T\)</span>是真实解<span class="math inline">\(T^*\)</span>的近似解，即<span class="math inline">\(R(T^*,x)\equiv 0\)</span>。然而，对任意的<span class="math inline">\(T\neq T^*\)</span>，我们不能令残差在每个<span class="math inline">\(x\)</span>点都消失。加权残差法的原理是，我们可以将残差乘以加权函数，令加权残差的积分在每一点<span class="math inline">\(x\)</span>上变为0，即 <span class="math display">\[\int^L_0W(x)R(T,x)dx=0\tag{1.9}\]</span>
式中<span class="math inline">\(W(x)\)</span>为权重函数。通过选择不同的权重函数并将其替换到弱形式（1.9）中，我们可以生成一个关于未知参数<span class="math inline">\(a_j\)</span>线性方程组，该方程组用于确定偏微分方程近似解<span class="math inline">\(T\)</span>的形式，该近似解类似于方程（1.7）给出的有限级数。这种方法满足偏微分方程的“平均”或“积分”意义上的解。所选加权函数的类型取决于所选加权残差函数的类型。在Galerkin方法中，<strong><em>权重与形状函数<span class="math inline">\(\phi(x)\)</span>相等，即<span class="math inline">\(W_i(x)=\phi_i(x)\)</span></em></strong>。
<br>由于未知参数<span class="math inline">\(a_j\)</span>的数量等于形状函数<span class="math inline">\(\phi_j\)</span>的数量，将生成一个方程数量与未知数数量相同的线性代数方程组。如果与偏微分方程相关的边界条件被正确设定和施加，那么这样的方程组的存在性和唯一性是保证的。这种方法在处理高维不规则几何和非线性问题中特别有优势，并且会自动生成一个方程数量与未知数数量相同的方程组。形状函数<span class="math inline">\(\phi(x)\)</span>的定义是有限元方法的关键所在。我们将几乎完全局限于使用简单（线性、二次和三次）插值；可以使用更高阶（和超越）近似，但这会带来额外的复杂性、计算时间和存储要求。使用基本线性、二次函数将证实有限元概念既优雅又极其强大。
<br>我们现在希望使用我们提出的形状函数<span class="math inline">\(\phi(x)\)</span>作为权重函数<span class="math inline">\(W(x)\)</span>来评估方程（1.9）的左端积分。因此，根据伽辽金方法得到：
<span class="math display">\[\int^L_0\phi(x)\Big
[-K\frac{d^2T}{dx^2}-Q\Big ]dx=0\tag{1.10}\]</span>
我们需要找到方程（1.7）中函数<span class="math inline">\(\phi(x)\)</span>的适当形式。由于温度分布必须是<span class="math inline">\(x\)</span>的连续函数，最简单的方法是在每个单元上使用分段多项式插值来近似它；特别是，分段线性近似提供了最简单的连续函数近似。不幸的是，这样的函数的一阶导数在单元节点处不连续，因此，在这些地方不存在二阶导数；此外，<span class="math inline">\(T\)</span>的二阶导数在每个单元内部将消失。然而，要求二阶导数在所有地方都存在是过于严格的。这将阻止我们处理许多非常有兴趣的物理情况，例如在杆中存在一个单位强度的热源。在这种情况下，方程（1.1）变为
<span class="math display">\[-K\frac{d^2T}{dx^2}=\delta(x-x_s)\tag{1.11}\]</span>
式中<span class="math inline">\(\delta\)</span>为Delta函数，在<span class="math inline">\(x=x_s\)</span>外的各点为0，且在这一点处的值不确定。显然，在<span class="math inline">\(x=x_s\)</span>处<span class="math inline">\(T\)</span>的二阶导数不存在；方程（1.11）的解为：
<span class="math display">\[T(x)=
\begin{cases}
-\dfrac{1}{K}[q(x-L)+(x_s-L)]+T_L&amp;0\le x\le x_s\\
-\dfrac{1}{K}q(x-L)(x-L)+T_L&amp;x_s\le x\le L
\end{cases}\tag{1.12}
\]</span> 对方程（1.10）应用分部积分，得到 <span class="math display">\[\int^L_0\phi(x)\left[-K\frac{d^2
T}{dx^2}\right]dx=\int^L_0K\frac{d\phi}{dx}\frac{dT}{dx}dx-K\phi\frac{dT}{dx}\Big
|^L_0\tag{1.13}
\]</span> 于是方程（1.10）可重写为 <span class="math display">\[\int^L_0K\frac{d\phi}{dx}\frac{dT}{dx}dx-\int^L_0\phi
Qdx-K\phi\frac{dT}{dx}\Big |^L_0=0\tag{1.14}
\]</span> 这仅仅是一个“弱”形式的问题，因为它只包含解<span class="math inline">\(T(x)\)</span>的一阶导数，而方程（1.10）包含二阶导数。对函数<span class="math inline">\(T(x)\)</span>的微分要求已经减弱，因此得名“弱形式”。请注意，到目前为止还没有进行任何近似，也就是说，在表述中没有丢失任何东西，另一方面，简单的分段线性近似现在变得合理。</p>
<blockquote>
<p><strong>例1</strong> 考虑方程（1.1），使用边界条件<span class="math inline">\(T(0)=T_0\)</span>以及对流边界条件<span class="math inline">\(-K\frac{dT}{dx}\Big
|_{x=L}=h(T-T_\infty)\)</span>。式中<span class="math inline">\(h\)</span>为热对流传导常数，<span class="math inline">\(T_\infty\)</span>为参考温度。
加权残差公式（式（1.9）），对于这个问题保持不变，因为它由式（1.1）推导而来，与给定的边界条件无关。每当在边界点给出温度时，我们将在该点的热流项设为零，通过要求权重函数在该点消失来实现。在这种情况下，令<span class="math inline">\(\phi(0) =
0\)</span>，并使用其他边界项中的对流边界条件，方程（1.9）的形式变为
<span class="math display">\[\int^L_0K\frac{d\phi}{dx}\frac{dT}{dx}-\int^L_0\phi
Qdx+\phi(L)h(T_L-T_\infty)=0\tag{1.15}\]</span>
即加权残差公式。稍后，我们将进一步要求加权函数在边界点处等于1。在这种情况下，<span class="math inline">\(\phi(L) =
1\)</span>，因此加权函数永远不会明确出现在边界项中。</p>
</blockquote>
对每个权重函数<span class="math inline">\(\phi(x)\)</span>使用公式（1.7），可将方程（1.14）改写为
<span class="math display">\[\sum^{n+1}_{j=1}K\Big
[\int^L_0\frac{d\phi_i}{dx}\frac{d\phi_j}{dx}dx\Big
]a_j-\int^L_0\phi_iQdx+\phi_i\Big[-K\frac{dT}{dx}\Big]\Big
|^{x=L}_{x=0}=0\\
i=1,2,\cdots,n+1\tag{1.16}
\]</span> 一旦形状函数<span class="math inline">\(\phi_i\)</span>选择好后，可以计算上式的积分。弱形式的伽辽金描述的优势在于，只有有限数量的参数<span class="math inline">\(a_i\)</span>需要确定，<span class="math inline">\(i = 1, \cdots, n +
1\)</span>，这与方程(1.1)或(1.9)中需要确定<span class="math inline">\(0
\le x &lt; L\)</span>区间内每个点的<span class="math inline">\(T(x)\)</span>值不同。在这种情况下，考虑精确解被兼容的近似所取代。
<br>为了说明上述过程，我们将区间<span class="math inline">\([0,
1]\)</span>分为两个等长的段，并在每个段的两个端点放置一个节点。因此，三个节点定义了整个杆的温度场，即节点<span class="math inline">\(1\)</span>位于<span class="math inline">\(x = x_1
= 0\)</span>，节点<span class="math inline">\(2\)</span>位于<span class="math inline">\(x = x_2 = L/2\)</span>，节点<span class="math inline">\(3\)</span>位于<span class="math inline">\(x = x_3
= L\)</span>，如图1所示。 <br>
<center>
<figure>
<img src="/2024/08/31/%E6%9C%89%E9%99%90%E5%85%83%E7%90%86%E8%AE%BA%E6%8E%A8%E5%AF%BC%EF%BC%88%E4%B8%80%EF%BC%89/1.png" alt="图1 区间离散化">
<figcaption aria-hidden="true">图1 区间离散化</figcaption>
</figure>
</center>
如果我们假设在节点之间的<span class="math inline">\(\phi(x)\)</span>在每个单元节点<span class="math inline">\(e_i\)</span>之间的变化为线性，我们可以使用下述形式表示<span class="math inline">\(T(x)\)</span>: <span class="math display">\[T(x)=\phi_{i}(x)a_i+\phi_{i+1}a_{i+1},x_i\le x\le
x_{i+1}\tag{1.17}\]</span> 如确定形状函数<span class="math inline">\(\phi_i\)</span>，使得<span class="math inline">\(\phi(x_i)=0\)</span>且<span class="math inline">\(\phi(x_{i+1})=0\)</span>，相反地<span class="math inline">\(\phi_{i+1}(x_i)=0\)</span>，<span class="math inline">\(\phi_{i+1}(x_{i+1})=1\)</span>，函数<span class="math inline">\(\phi_i\)</span>由下式给出： <span class="math display">\[\phi_i(x)=\frac{x_{i+1}-x}{x_{i+1}-x_i}\tag{1.18a}\]</span>
<span class="math display">\[\phi_{i+1}(x)=\frac{x-x_i}{x_{i+1}-x_i}\tag{1.18b}\]</span>
参数<span class="math inline">\(a_i\)</span>为节点温度，即<span class="math inline">\(a_i=T(x_i)=T_i\)</span>，形状函数的导数为 <span class="math display">\[\frac{d\phi_i}{dx}=-\frac{1}{x_{i+1}-x_i}\tag{1.19a}\]</span>
<span class="math display">\[\frac{d\phi_{i+1}}{dx}=\frac{1}{x_{i+1}-x_i}\tag{1.19b}\]</span>
<br>
<center>
<figure>
<img src="/2024/08/31/%E6%9C%89%E9%99%90%E5%85%83%E7%90%86%E8%AE%BA%E6%8E%A8%E5%AF%BC%EF%BC%88%E4%B8%80%EF%BC%89/2.png" alt="图2 一个单元上的形状函数">
<figcaption aria-hidden="true">图2 一个单元上的形状函数</figcaption>
</figure>
</center>
<p>方程（1.17）~（1.19）可以使用矩阵形式表述为 <span class="math display">\[T(x)=\phi \boldsymbol{a}\tag{1.20}\]</span> 式中
<span class="math display">\[\phi=\begin{matrix}
[\phi_i &amp;\phi_{i+1}]
\end{matrix}\tag{1.21}\]</span> 由此得到 <span class="math display">\[\frac{dT}{dx}=\frac{d}{dx}\phi\boldsymbol{a}=
\left[\begin{matrix}
\dfrac{d\phi_i}{dx}&amp;\dfrac{d\phi_{i+1}}{dx}
\end{matrix}
\right]
\Big[
\begin{matrix}
a_i\\a_{i+1}
\end{matrix}
\Big]\tag{1.22}\]</span> 其中 <span class="math display">\[\frac{d}{dx}\phi=\left[
\begin{matrix}
-\dfrac{1}{x_{i+1}-x_i}&amp;\dfrac{1}{x_{i+1}-x_i}
\end{matrix}
\right]\tag{1.23}\]</span> 现在可将以上方程带入到方程（1.16）中，得到
<span class="math display">\[\sum^2_{j=1}K\left[\int^{L/2}_0\frac{d\phi_1}{dx}\frac{d\phi_j}{dx}dx\right]a_j-\int^{L/2}_0\phi_1(x)Qdx-K\phi_1(x)\frac{dT}{dx}\Big|^{x=L/2}_{x=0}=0\\
\tag{1.24a}\]</span> 和 <span class="math display">\[\sum^2_{j=1}K\left[\int^{L/2}_0\frac{d\phi_2}{dx}\frac{d\phi_j}{dx}dx\right]a_j-\int^{L/2}_0\phi_2(x)Qdx-K\phi_2(x)\frac{dT}{dx}\Big|^{x=L/2}_{x=0}=0\\
\tag{1.24b}\]</span> 上式使用方程（1.20）~（1.23）表述为 <span class="math display">\[K\left[\int^{L/2}_0\left[\frac{d}{dx}\phi\right]^T\left[\frac{d}{dx}\phi\right]dx\right]\boldsymbol{a}-Q\int^{L/2}_0\phi^Tdx-\left[
\begin{matrix}
q\\0
\end{matrix}
\right]=0\tag{1.25}\]</span> 代入 <span class="math display">\[\phi=\left[
  \begin{matrix}
  1-\dfrac{2x}{L}&amp;\dfrac{2x}{L}
  \end{matrix}
  \right]\]</span> 和 <span class="math display">\[\frac{d}{dx}\phi=\Big[
  \begin{matrix}
  -\dfrac{2}{L}&amp;\dfrac{2}{L}
  \end{matrix}
  \Big]\]</span> 并积分，得到 <span class="math display">\[\frac{2K}{L}\left[
  \begin{matrix}
    1&amp;-1\\
    -1&amp;1\\
  \end{matrix}
  \right]
  \left[
    \begin{matrix}
      a_1\\
      a_2
    \end{matrix}
  \right]-\frac{QL}{4}
  \left[
  \begin{matrix}
    1\\1
  \end{matrix}  
  \right]-
  \Big[\begin{matrix}
    q\\0
  \end{matrix}
  \Big]=\Big[\begin{matrix}
    0\\0
  \end{matrix}
  \Big]\tag{1.26}\]</span> 单元<span class="math inline">\(2\)</span>使用相似的方法计算得到 <span class="math display">\[\frac{2K}{L}\Big[
  \begin{matrix}
    1&amp;-1\\
    -1&amp;1\\
  \end{matrix}
  \Big]
  \Big[
    \begin{matrix}
      a_2\\
      a_3
    \end{matrix}
  \Big]-\frac{QL}{4}
  \Big[
  \begin{matrix}
    1\\1
  \end{matrix}  
  \Big]-
  \Big[\begin{matrix}
    q\\0
  \end{matrix}
  \Big]=\Big[\begin{matrix}
    0\\0
  \end{matrix}
  \Big]\tag{1.27}\]</span>
表达式（1.26）和（1.27）通过“组装”，即将方程（1.26）中的第二个方程和方程（1.27）中的第一个方程相加，因为它们都对应于相同的权重函数<span class="math inline">\(\phi_2(x)\)</span>，于是得到 <span class="math display">\[\frac{2K}{L}\left[
    \begin{matrix}
      1&amp;-1&amp;0\\
      -1&amp;2&amp;-1\\
      0&amp;-1&amp;1
    \end{matrix}
    \right]
    \left[
    \begin{matrix}
      a_1\\
      a_2\\
      a_3
    \end{matrix}
    \right]=
    \left[
    \begin{matrix}
      q\\
      0\\
      0
    \end{matrix}
    \right]+\frac{QL}{4}
    \left[
    \begin{matrix}
      1\\
      2\\
      1
    \end{matrix}
    \right]\tag{1.28}
  \]</span> 由于已知<span class="math inline">\(a_3=T_L\)</span>，上述公式简化为关于未知数<span class="math inline">\(a_1\)</span>和<span class="math inline">\(a_2\)</span>，即 <span class="math display">\[a_1-a_2=\frac{ql}{2K}+\frac{QL^2}{8K}\tag{1.29a}\]</span>
<span class="math display">\[-a_1+2a_2=\frac{QL^2}{4K}+T_L\tag{1.29b}\]</span>
解为 <span class="math display">\[a_1=\frac{qL}{K}+\frac{QL^2}{2K}+T_L,\\
a_2=\frac{qL}{2K}+\frac{3QL^2}{8K}+T_L,\\
a_3=T_L\tag{1.30}\]</span></p>
<h2 id="小结">1.3 小结</h2>
<p>有限元方法的基本原理在于加权残差法。最常用的两种程序是<strong><em>Rayleigh-Ritz方法</em></strong>和<strong><em>伽辽金方法</em></strong>。Rayleigh-Ritz方法基于变分计算；然而，这种方法不能用于一些更复杂的方程。伽辽金方法简单易用，即使Rayleigh-Ritz方法无法应用，也能保证得到与主导微分方程兼容的近似解。
在这两种方法中，依赖变量通过一个有限系列近似表示，其中假设解的“形状”已知，并且取决于有限数量需要确定的参数。将伽辽金近似代入主导微分方程，产生的残差函数与权重函数相乘，要求在积分意义上与权重函数正交，即
<span class="math display">\[\int W(x)R(T,x)dx=0\]</span> 其中<span class="math inline">\(R(T, x)\)</span>是残差函数（当将近似精确解<span class="math inline">\(T^*\)</span>代入微分方程时得到的函数），<span class="math inline">\(W(x)\)</span>是权重函数。从这些表达式中生成的一组线性代数方程允许我们确定未知参数，从而得到解的近似值。通过使用积分换元法降低二阶导数项，我们得到了“弱形式”公式。应用弱形式公式产生了一个通用的算法，可扩展到广泛的问题类别。</p>

      </div>
    </div>
    
      <script src='https://unpkg.com/mermaid@latest/dist/mermaid.min.js'></script>
      <script>
        if (window.mermaid) {
          mermaid.initialize({"startOnload":true});
        }
      </script>
    
  </article>
  <div class="post__foot">
    
      <div class="like-author">
  <input type="checkbox" id="likeCode" />
  <div class="author-face">
    <img height="100px"
         width="100px"
         id="front-face"
         alt="author face"
         src="/assets/author-face.jpg" />
    <img height="100px"
         width="100px"
         id="back-face"
         alt="like code"
         src="/assets/pay-code.jpg" />
  </div>
  <div class="like-text">“给作者倒杯卡布奇诺”</div>
  <label for="likeCode" class="like-btn">
    <svg viewBox="0 0 1024 1024"
         width="20px"
         style="margin-right: 10px"
         height="20px">
      <path d="M466.88 908.96L113.824 563.296a270.08 270.08 0 0 1 0-387.392c108.8-106.56 284.896-106.56 393.696 0 1.504 1.472 2.976 2.944 4.448 4.48 1.472-1.536 2.944-3.008 4.448-4.48 108.8-106.56 284.896-106.56 393.696 0a269.952 269.952 0 0 1 34.016 347.072l-387.392 385.6a64 64 0 0 1-89.92 0.384z" p-id="13650" fill="#ee4242" />
    </svg>
    喜欢作者
  </label>
</div>

    
    <div class="post-nav">
  
    <a class="post-nav-item-left" href="/2024/09/05/%E6%9C%89%E9%99%90%E5%85%83%E7%90%86%E8%AE%BA%E6%8E%A8%E5%AF%BC%EF%BC%88%E4%BA%8C%EF%BC%89/">
      <div class="text-align">
        <svg t="1670570876164"
             class="icon"
             viewBox="0 0 1024 1024"
             width="16"
             height="16">
          <path d="M384 512L731.733333 202.666667c17.066667-14.933333 19.2-42.666667 4.266667-59.733334-14.933333-17.066667-42.666667-19.2-59.733333-4.266666l-384 341.333333c-10.666667 8.533333-14.933333 19.2-14.933334 32s4.266667 23.466667 14.933334 32l384 341.333333c8.533333 6.4 19.2 10.666667 27.733333 10.666667 12.8 0 23.466667-4.266667 32-14.933333 14.933333-17.066667 14.933333-44.8-4.266667-59.733334L384 512z" p-id="14596" />
        </svg>
        <span class="text-small">上一篇</span>
      </div>
      <div>04-有限元理论推导（二）</div>
    </a>
  
  <div class="vhr"></div>
  
    <a class="post-nav-item-right" href="/2024/08/31/%E6%9C%89%E9%99%90%E5%85%83%E5%88%9D%E6%AD%A5%EF%BC%88%E4%BA%8C%EF%BC%89/">
      <div class="text-align">
        <span class="text-small">下一篇</span>
        <svg t="1670570876164"
             class="icon"
             viewBox="0 0 1024 1024"
             transform="scale(-1,-1)"
             width="16"
             height="16">
          <path d="M384 512L731.733333 202.666667c17.066667-14.933333 19.2-42.666667 4.266667-59.733334-14.933333-17.066667-42.666667-19.2-59.733333-4.266666l-384 341.333333c-10.666667 8.533333-14.933333 19.2-14.933334 32s4.266667 23.466667 14.933334 32l384 341.333333c8.533333 6.4 19.2 10.666667 27.733333 10.666667 12.8 0 23.466667-4.266667 32-14.933333 14.933333-17.066667 14.933333-44.8-4.266667-59.733334L384 512z" p-id="14596" />
        </svg>
      </div>
      02-有限元初步（二）（翻译）
    </a>
  
</div>

    
      <div class="related-post">
  <div class="related__head">
  

</div>
  <div class="realated__body">
    
      <div class="null"><div class="null-item"><div class="null-title"><a href="\2024\09\05\有限元理论推导（二）\" title="04-有限元理论推导（二）" rel="bookmark">04-有限元理论推导（二）</a></div></div><div class="null-item"><div class="null-title"><a href="\2024\07\30\有限元初步（一）\" title="01-有限元初步（一）（翻译）" rel="bookmark">01-有限元初步（一）（翻译）</a></div></div></div>
    
  </div>
</div>

    
    
  </div>

    </div>
    <div class="foot">
      <div class="foot-inner">
        <div class="foot__head">
          
            <div class="foot-line">
              <div class="matts">海</div><div class="matts">内</div><div class="matts">存</div><div class="matts">知</div><div class="matts">己</div>
            </div>
          
            <div class="foot-line">
              <div class="matts">天</div><div class="matts">涯</div><div class="matts">若</div><div class="matts">比</div><div class="matts">邻</div>
            </div>
          
        </div>
        <div class="foot__body">
          
          
            <div class="foot-item">
              <div class="foot-item__head">账号</div>
              <div class="foot-item__body">
                
                  <div class="text">
                    <img alt="link" height="20px" width="20px" src="/images/logo-github.svg" />
                    <a class="foot-link" target="_blank" rel="noopener" href="https://github.com/Wangszjl">芥川龙之介的幽灵</a>
                  </div>
                
              </div>
            </div>
          
          <div class="foot-item">
            <div class="foot-item__head">联系</div>
            <div class="foot-item__body">
              <div class="text">
                <img alt="link" height="20px" width="20px" src="/images/icon/icon-email.svg" />
                <a class="foot-link" href="mailto:wangsizhan1994@163.com">wangsizhan1994@163.com</a>
              </div>
            </div>
          </div>
        </div>
        <div class="copyright">
          <a href="http://example.com">芥川龙之介的幽灵</a> &nbsp;|&nbsp;由&nbsp;<a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>&nbsp;及&nbsp;
          <svg width="20" height="20" viewBox="0 0 725 725">
            <path fill-rule="evenodd" fill="rgb(221, 221, 221)" d="M145.870,236.632 L396.955,103.578 L431.292,419.44 L156.600,522.53 L145.870,236.632 Z" />
            <path fill-rule="evenodd" fill="rgb(159, 159, 159)" d="M396.955,103.578 L564.345,234.486 L611.558,513.469 L431.292,419.44 L396.955,103.578 Z" />
            <path fill-rule="evenodd" fill="rgb(0, 0, 0)" d="M431.292,419.44 L611.558,513.469 L358.327,595.18 L156.600,522.53 L431.292,419.44 Z" />
          </svg>
          <a target="_blank" rel="noopener" href="https://github.com/hooozen/hexo-theme-tranquility">致远</a>&nbsp;驱动
        </div>
      </div>
    </div>
    
      <script src="https://unpkg.com/js-polyfills@0.1.43/es6.js"></script>
      <script id="MathJax-script"
              async
              src="https://www.unpkg.com/mathjax@3.2.2/es5/tex-mml-chtml.js"></script>
    
    
      <script src="/js/search.js"></script>
      <script>searchInitialize("/search.json")</script>
    
    
  

  </body>
</html>
